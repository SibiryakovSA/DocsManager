@{
    Layout = null;
}
@model List<IObjInDir>

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Default</title>
    <link rel="stylesheet" href="~/css/Style.css" />
</head>
<body>
    <header>
        <h1>Файловое хранилище имени меня</h1>
    </header>

    <form method="post" enctype="multipart/form-data" asp-controller="UploadFiles" asp-action="Index">
            <input type="hidden" value="@Context.Request.Query["relativeFolderPath"].ToString()" name="relativeFolderPath"/>
            <input type="file" accept=".doc, .xls" name="files" multiple>
            <input type="submit" value="Загрузить">
    </form>

    <h3>Все элементы</h3>
    <h2>Количество элементов в папке: @Model.Count</h2>
    @foreach (var elem in Model)
    {
        <div class="item">
           @if (elem is DocFile)
           {
                <form method="post" enctype="multipart/form-data" asp-controller="DeleteFile" asp-action="Index">
                    <input type="hidden" value="@elem" name="obj" />
                    <input type="hidden" value="@Context.Request.Query["relativeFolderPath"].ToString()" name="relativeFolderPath" />
                    <input type="submit" value="X" />
                </form>

                <img src="~/images/@(elem.Extention + ".png")"/>
                <p>@String.Format("{0}.{1}", elem.Name, elem.Extention)</p>
                <p><a href="@string.Format("{0}://{1}{2}", Context.Request.Scheme, Context.Request.Host, "/default/GetFile?fileName=" + elem.Name + (elem.RelativeFolderPath != "" ? "&relativeFolderPath=" + elem.RelativeFolderPath : ""))">Загрузить</a></p>
            }
            else if (elem is Folder)
            {
                <a href="@string.Format("{0}://{1}{2}", Context.Request.Scheme, Context.Request.Host, "/default/ViewFolder?relativeFolderPath=" + (elem as Folder).RelativeFolderPath + "\\")"> <img src="~/images/folder.png"/> </a> 
                <p>@elem.Name</p>
            }
        </div>
     }
</body>
</html>
